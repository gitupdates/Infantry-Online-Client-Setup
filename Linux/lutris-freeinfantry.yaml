# Date : (2022-02-20 14-00)
# Last revision : (2024-02-12 06-19)
# Wine version used : 7.0.0
# Distribution used to test : Ubuntu 20.04 LTS
# Author : Spiff
# Reference : https://github.com/lutris/lutris/blob/master/docs/installers.rst

name: "FreeInfantry"
game_slug: "freeinfantry"
version: "Installer"
slug: "freeinfantry-installer"
runner: "wine"

script:
  game:
    arch: win32
    exe: $GAMEDIR/drive_c/ProgramData/FreeInfantry/InfantryLauncher.exe
    prefix: $GAMEDIR
    working_dir: $GAMEDIR/drive_c/ProgramData/FreeInfantry/

  files:
  - infantryinstaller: http://freeinfantry.com/download/win/latest/Install-FreeInfantry.exe
  - infantrybanner: http://freeinfantry.com/download/installer-images/linux-lutris-banner-184x69.jpg

  installer:
  - task:
      app: dotnet452
      description: "Step (1/2) - Installing .NET 4.5.2..."
      name: winetricks
      prefix: $GAMEDIR
  - task:
      description: "Step (2/2) - Installing FreeInfantry..."
      executable: infantryinstaller
      args: "/ddraw=opengl /S"
      name: wineexec
      prefix: $GAMEDIR
  - move:
      src: infantrybanner
      dst: $GAMEDIR/freeinfantry.jpg
  - execute:
      command: mkdir -p ~/.local/share/lutris/banners
      description: Create the banners folder if needed
  - execute:
      command: cp $GAMEDIR/freeinfantry.jpg ~/.local/share/lutris/banners/
      description: Move the banner to the lutris banner folder
  wine:
      dxvk: "false"
      vkd3d: "false"
      d3d_extras: "false"
      dxvk_nvapi: "false"
      overrides:
          ddraw.dll: "n,b"
